[üìÅ Sfs It Developement GitHub](/cerulean-circle-unlimited-2cu/product/development/2cu-custom-development/sfs-it-developement.md) | [üåê Index Structure GitHub](/cerulean-circle-unlimited-2cu/product/development/2cu-custom-development/sfs-it-developement/proxy-detail-for-nextcloud.md) | [üåê Index Structure local SymLink](./proxy-detail-for-nextcloud.entry.md)

# Proxy Detail  For Nextcloud

| **Default Nginx Configuration** | **Updated Nginx Configuration** |
| --- | --- |
| File Location/Name: /var/www/vhosts/system/box.sfsre.de/conf/nginx.conf<br><br>```<br>#ATTENTION!<br>#<br>#DO NOT MODIFY THIS FILE BECAUSE IT WAS GENERATED AUTOMATICALLY,<br>#SO ALL YOUR CHANGES WILL BE LOST THE NEXT TIME THE FILE IS GENERATED.<br><br>server {<br>	listen 195.90.210.123:443 ssl http2;<br><br>	server_name box.sfsre.de;<br>	server_name www.box.sfsre.de;<br>	server_name ipv4.box.sfsre.de;<br><br>	ssl_certificate             /opt/psa/var/certificates/scfysrTJK;<br>	ssl_certificate_key         /opt/psa/var/certificates/scfysrTJK;<br>	ssl_client_certificate      /opt/psa/var/certificates/scfDrAjUT;<br><br>	client_max_body_size 128m;<br><br>	proxy_read_timeout 1000;<br><br>	root "/var/www/vhosts/sfsre.de/box.sfsre.de";<br>	access_log "/var/www/vhosts/system/box.sfsre.de/logs/proxy_access_ssl_log";<br>	error_log "/var/www/vhosts/system/box.sfsre.de/logs/proxy_error_log";<br><br>	#extension letsencrypt begin<br>	location ^~ /.well-known/acme-challenge/ {<br>		root /var/www/vhosts/default/htdocs;<br><br>		types { }<br>		default_type text/plain;<br><br>		satisfy any;<br>		auth_basic off;<br>		allow all;<br><br>		location ~ ^/\.well-known/acme-challenge.*/\. {<br>			deny all;<br>		}<br>	}<br>	#extension letsencrypt end<br><br>	location / {<br>		proxy_pass https://195.90.210.123:7081;<br>		proxy_set_header Host             $host;<br>		proxy_set_header X-Real-IP        $remote_addr;<br>		proxy_set_header X-Forwarded-For  $proxy_add_x_forwarded_for;<br>		proxy_set_header X-Accel-Internal /internal-nginx-static-location;<br>		access_log off;<br><br>	}<br><br>	location /internal-nginx-static-location/ {<br>		alias /var/www/vhosts/sfsre.de/box.sfsre.de/;<br>		internal;<br>	}<br><br>	location ~ ^/(plesk-stat\|awstats-icon\|webstat\|webstat-ssl\|ftpstat\|anon_ftpstat) {<br>		proxy_pass https://195.90.210.123:7081;<br>		proxy_set_header Host             $host;<br>		proxy_set_header X-Real-IP        $remote_addr;<br>		proxy_set_header X-Forwarded-For  $proxy_add_x_forwarded_for;<br>		proxy_set_header X-Accel-Internal /internal-nginx-static-location;<br>		access_log off;<br><br>	}<br><br>	location ~ ^/~(.+?)(/.*?\.php)(/.*)?$ {<br>		alias /var/www/vhosts/sfsre.de/web_users/$1/$2;<br>		fastcgi_split_path_info ^((?U).+\.php)(/?.+)$;<br>		fastcgi_param PATH_INFO $fastcgi_path_info;<br>		fastcgi_pass "unix:///var/www/vhosts/system/box.sfsre.de/php-fpm.sock";<br>		include /etc/nginx/fastcgi.conf;<br><br>	}<br><br>	location ~ ^/~(.+?)(/.*)?$ {<br>		proxy_pass https://195.90.210.123:7081;<br>		proxy_set_header Host             $host;<br>		proxy_set_header X-Real-IP        $remote_addr;<br>		proxy_set_header X-Forwarded-For  $proxy_add_x_forwarded_for;<br>		proxy_set_header X-Accel-Internal /internal-nginx-static-location;<br>		access_log off;<br><br>	}<br><br>	location ~ \.php(/.*)?$ {<br>		fastcgi_split_path_info ^((?U).+\.php)(/?.+)$;<br>		fastcgi_param PATH_INFO $fastcgi_path_info;<br>		fastcgi_pass "unix:///var/www/vhosts/system/box.sfsre.de/php-fpm.sock";<br>		include /etc/nginx/fastcgi.conf;<br><br>	}<br><br>	location ~ /$ {<br>		index "index.html" "index.cgi" "index.pl" "index.php" "index.xhtml" "index.htm" "index.shtml";<br>	}<br><br>	add_header X-Powered-By PleskLin;<br><br>}<br><br>server {<br>	listen 195.90.210.123:80;<br><br>	server_name box.sfsre.de;<br>	server_name www.box.sfsre.de;<br>	server_name ipv4.box.sfsre.de;<br><br>	client_max_body_size 128m;<br><br>	proxy_read_timeout 1000;<br><br>	root "/var/www/vhosts/sfsre.de/box.sfsre.de";<br>	access_log "/var/www/vhosts/system/box.sfsre.de/logs/proxy_access_log";<br>	error_log "/var/www/vhosts/system/box.sfsre.de/logs/proxy_error_log";<br><br>	#extension letsencrypt begin<br>	location ^~ /.well-known/acme-challenge/ {<br>		root /var/www/vhosts/default/htdocs;<br><br>		types { }<br>		default_type text/plain;<br><br>		satisfy any;<br>		auth_basic off;<br>		allow all;<br><br>		location ~ ^/\.well-known/acme-challenge.*/\. {<br>			deny all;<br>		}<br>	}<br>	#extension letsencrypt end<br><br>	location / {<br>		proxy_pass http://195.90.210.123:7080;<br>		proxy_set_header Host             $host;<br>		proxy_set_header X-Real-IP        $remote_addr;<br>		proxy_set_header X-Forwarded-For  $proxy_add_x_forwarded_for;<br>		proxy_set_header X-Accel-Internal /internal-nginx-static-location;<br>		access_log off;<br><br>	}<br><br>	location /internal-nginx-static-location/ {<br>		alias /var/www/vhosts/sfsre.de/box.sfsre.de/;<br>		internal;<br>	}<br><br>	location ~ ^/(plesk-stat\|awstats-icon\|webstat\|webstat-ssl\|ftpstat\|anon_ftpstat) {<br>		proxy_pass http://195.90.210.123:7080;<br>		proxy_set_header Host             $host;<br>		proxy_set_header X-Real-IP        $remote_addr;<br>		proxy_set_header X-Forwarded-For  $proxy_add_x_forwarded_for;<br>		proxy_set_header X-Accel-Internal /internal-nginx-static-location;<br>		access_log off;<br><br>	}<br><br>	location ~ ^/~(.+?)(/.*?\.php)(/.*)?$ {<br>		alias /var/www/vhosts/sfsre.de/web_users/$1/$2;<br>		fastcgi_split_path_info ^((?U).+\.php)(/?.+)$;<br>		fastcgi_param PATH_INFO $fastcgi_path_info;<br>		fastcgi_pass "unix:///var/www/vhosts/system/box.sfsre.de/php-fpm.sock";<br>		include /etc/nginx/fastcgi.conf;<br><br>	}<br><br>	location ~ ^/~(.+?)(/.*)?$ {<br>		proxy_pass http://195.90.210.123:7080;<br>		proxy_set_header Host             $host;<br>		proxy_set_header X-Real-IP        $remote_addr;<br>		proxy_set_header X-Forwarded-For  $proxy_add_x_forwarded_for;<br>		proxy_set_header X-Accel-Internal /internal-nginx-static-location;<br>		access_log off;<br><br>	}<br><br>	location ~ \.php(/.*)?$ {<br>		fastcgi_split_path_info ^((?U).+\.php)(/?.+)$;<br>		fastcgi_param PATH_INFO $fastcgi_path_info;<br>		fastcgi_pass "unix:///var/www/vhosts/system/box.sfsre.de/php-fpm.sock";<br>		include /etc/nginx/fastcgi.conf;<br><br>	}<br><br>	location ~ /$ {<br>		index "index.html" "index.cgi" "index.pl" "index.php" "index.xhtml" "index.htm" "index.shtml";<br>	}<br><br>	add_header X-Powered-By PleskLin;<br><br>}<br>``` | File Location/Name: /var/www/vhosts/system/box.sfsre.de/conf/vhost\_nginx.conf<br><br>```<br>#ATTENTION!<br>#<br>#DO NOT MODIFY THIS FILE BECAUSE IT WAS GENERATED AUTOMATICALLY,<br>#SO ALL YOUR CHANGES WILL BE LOST THE NEXT TIME THE FILE IS GENERATED.<br><br>server {<br>	listen 195.90.210.123:443 ssl http2;<br><br>	server_name box.sfsre.de;<br>	server_name www.box.sfsre.de;<br>	server_name ipv4.box.sfsre.de;<br><br>	ssl_certificate             /opt/psa/var/certificates/scfysrTJK;<br>	ssl_certificate_key         /opt/psa/var/certificates/scfysrTJK;<br>	ssl_client_certificate      /opt/psa/var/certificates/scfDrAjUT;<br><br>	client_max_body_size 128m;<br><br>	proxy_read_timeout 1000;<br><br>	root "/var/www/vhosts/sfsre.de/box.sfsre.de";<br>	access_log "/var/www/vhosts/system/box.sfsre.de/logs/proxy_access_ssl_log";<br>	error_log "/var/www/vhosts/system/box.sfsre.de/logs/proxy_error_log";<br><br>	#extension letsencrypt begin<br>	location ^~ /.well-known/acme-challenge/ {<br>		root /var/www/vhosts/default/htdocs;<br><br>		types { }<br>		default_type text/plain;<br><br>		satisfy any;<br>		auth_basic off;<br>		allow all;<br><br>		location ~ ^/\.well-known/acme-challenge.*/\. {<br>			deny all;<br>		}<br>	}<br>	#extension letsencrypt end<br><br>	location / {<br>		#proxy_pass https://195.90.210.123:7081;<br>		proxy_pass http://www.box.sfsre.de:8081;<br>		proxy_set_header Host             $host;<br>		proxy_set_header X-Real-IP        $remote_addr;<br>		proxy_set_header X-Forwarded-For  $proxy_add_x_forwarded_for;<br>		proxy_set_header X-Accel-Internal /internal-nginx-static-location;<br>		access_log off;<br><br>	}<br><br>	location /internal-nginx-static-location/ {<br>		alias /var/www/vhosts/sfsre.de/box.sfsre.de/;<br>		internal;<br>	}<br><br>	location ~ ^/(plesk-stat\|awstats-icon\|webstat\|webstat-ssl\|ftpstat\|anon_ftpstat) {<br>		proxy_pass https://195.90.210.123:7081;<br>		proxy_set_header Host             $host;<br>		proxy_set_header X-Real-IP        $remote_addr;<br>		proxy_set_header X-Forwarded-For  $proxy_add_x_forwarded_for;<br>		proxy_set_header X-Accel-Internal /internal-nginx-static-location;<br>		access_log off;<br><br>	}<br><br>	location ~ ^/~(.+?)(/.*?\.php)(/.*)?$ {<br>		alias /var/www/vhosts/sfsre.de/web_users/$1/$2;<br>		fastcgi_split_path_info ^((?U).+\.php)(/?.+)$;<br>		fastcgi_param PATH_INFO $fastcgi_path_info;<br>		fastcgi_pass "unix:///var/www/vhosts/system/box.sfsre.de/php-fpm.sock";<br>		include /etc/nginx/fastcgi.conf;<br><br>	}<br><br><br>	add_header X-Powered-By PleskLin;<br><br>}<br><br>server {<br>	listen 195.90.210.123:80;<br><br>	server_name box.sfsre.de;<br>	server_name www.box.sfsre.de;<br>	server_name ipv4.box.sfsre.de;<br><br>	client_max_body_size 128m;<br><br>	proxy_read_timeout 1000;<br><br>	root "/var/www/vhosts/sfsre.de/box.sfsre.de";<br>	access_log "/var/www/vhosts/system/box.sfsre.de/logs/proxy_access_log";<br>	error_log "/var/www/vhosts/system/box.sfsre.de/logs/proxy_error_log";<br><br>	#extension letsencrypt begin<br>	location ^~ /.well-known/acme-challenge/ {<br>		root /var/www/vhosts/default/htdocs;<br><br>		types { }<br>		default_type text/plain;<br><br>		satisfy any;<br>		auth_basic off;<br>		allow all;<br><br>		location ~ ^/\.well-known/acme-challenge.*/\. {<br>			deny all;<br>		}<br>	}<br>	#extension letsencrypt end<br><br>	location / {<br>		#proxy_pass http://195.90.210.123:7080;<br>		proxy_pass https://www.box.sfsre.de;<br>		proxy_set_header Host             $host;<br>		proxy_set_header X-Real-IP        $remote_addr;<br>		proxy_set_header X-Forwarded-For  $proxy_add_x_forwarded_for;<br>		proxy_set_header X-Accel-Internal /internal-nginx-static-location;<br>		access_log off;<br><br>	}<br><br>	location /internal-nginx-static-location/ {<br>		alias /var/www/vhosts/sfsre.de/box.sfsre.de/;<br>		internal;<br>	}<br><br>	location ~ ^/(plesk-stat\|awstats-icon\|webstat\|webstat-ssl\|ftpstat\|anon_ftpstat) {<br>		proxy_pass http://195.90.210.123:7080;<br>		proxy_set_header Host             $host;<br>		proxy_set_header X-Real-IP        $remote_addr;<br>		proxy_set_header X-Forwarded-For  $proxy_add_x_forwarded_for;<br>		proxy_set_header X-Accel-Internal /internal-nginx-static-location;<br>		access_log off;<br><br>	}<br>	add_header X-Powered-By PleskLin;<br><br>}<br><br>``` |
|     |     |

To Automate this process we need to make vhost\_nginx.conf as default page
